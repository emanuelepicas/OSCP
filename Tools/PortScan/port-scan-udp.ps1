{"payload":{"allShortcutsEnabled":false,"fileTree":{"":{"items":[{"name":"LICENSE","path":"LICENSE","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"adlogin.ps1","path":"adlogin.ps1","contentType":"file"},{"name":"localbrute-extra-mini.ps1","path":"localbrute-extra-mini.ps1","contentType":"file"},{"name":"localbrute.ps1","path":"localbrute.ps1","contentType":"file"},{"name":"port-scan-tcp-compat.ps1","path":"port-scan-tcp-compat.ps1","contentType":"file"},{"name":"port-scan-tcp.ps1","path":"port-scan-tcp.ps1","contentType":"file"},{"name":"port-scan-udp.ps1","path":"port-scan-udp.ps1","contentType":"file"},{"name":"smblogin-extra-mini.ps1","path":"smblogin-extra-mini.ps1","contentType":"file"},{"name":"smblogin.ps1","path":"smblogin.ps1","contentType":"file"}],"totalCount":10}},"fileTreeProcessingTime":5.7522709999999995,"foldersToFetch":[],"reducedMotionEnabled":null,"repo":{"id":262841920,"defaultBranch":"master","name":"Minimalistic-offensive-security-tools","ownerLogin":"InfosecMatter","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2020-05-10T17:40:31.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/60963123?v=4","public":true,"private":false,"isOrgOwned":false},"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"master","listCacheKey":"v0:1589132434.0","canEdit":false,"refType":"branch","currentOid":"9537cbff1c7f6b15d1ed98da0a5dfaf9f8487940"},"path":"port-scan-udp.ps1","currentUser":null,"blob":{"rawLines":["Function port-scan-udp {\r","  param($hosts,$ports)\r","  if (!$ports) {\r","    Write-Host \"usage: port-scan-udp <host|hosts> <port|ports>\"\r","    Write-Host \" e.g.: port-scan-udp 192.168.1.2 445`n\"\r","    return\r","  }\r","  $out = \".\\scanresults.txt\"\r","  foreach($p in [array]$ports) {\r","   foreach($h in [array]$hosts) {\r","    $x = (gc $out -EA SilentlyContinue | select-string \"^$h,udp,$p,\")\r","    if ($x) {\r","      gc $out | select-string \"^$h,udp,$p,\"\r","      continue\r","    }\r","    $msg = \"$h,udp,$p,\"\r","    $u = new-object system.net.sockets.udpclient\r","    $u.Client.ReceiveTimeout = 500\r","    $u.Connect($h,$p)\r","    # Send a single byte 0x01\r","    [void]$u.Send(1,1)\r","    $l = new-object system.net.ipendpoint([system.net.ipaddress]::Any,0)\r","    $r = \"Filtered\"\r","    try {\r","      if ($u.Receive([ref]$l)) {\r","        # We have received some UDP data from the remote host in return\r","        $r = \"Open\"\r","      }\r","    } catch {\r","      if ($Error[0].ToString() -match \"failed to respond\") {\r","        # We haven't received any UDP data from the remote host in return\r","        # Let's see if we can ICMP ping the remote host\r","        if ((Get-wmiobject win32_pingstatus -Filter \"address = '$h' and Timeout=1000 and ResolveAddressNames=false\").StatusCode -eq 0) {\r","          # We can ping the remote host, so we can assume that ICMP is not\r","          # filtered. And because we didn't receive ICMP port-unreachable before,\r","          # we can assume that the remote UDP port is open\r","          $r = \"Open\"\r","        }\r","      } elseif ($Error[0].ToString() -match \"forcibly closed\") {\r","        # We have received ICMP port-unreachable, the UDP port is closed\r","        $r = \"Closed\"\r","      }\r","    }\r","    $u.Close()\r","    $msg += $r\r","    Write-Host \"$msg\"\r","    echo $msg >>$out\r","   }\r","  }\r","}\r","\r","# Examples:\r","#\r","# port-scan-udp 10.10.0.1 137\r","# port-scan-udp 10.10.0.1 (135,137,445)\r","# port-scan-udp (gc .\\ips.txt) 137\r","# port-scan-udp (gc .\\ips.txt) (135,137,445)\r","# 0..255 | foreach { port-scan-udp 10.10.0.$_ 137 }\r","# 0..255 | foreach { port-scan-udp 10.10.0.$_ (135,137,445) }\r"],"stylingDirectives":[[{"start":0,"end":8,"cssClass":"pl-k"},{"start":9,"end":22,"cssClass":"pl-en"}],[{"start":2,"end":7,"cssClass":"pl-k"},{"start":8,"end":14,"cssClass":"pl-smi"},{"start":14,"end":15,"cssClass":"pl-k"},{"start":15,"end":21,"cssClass":"pl-smi"}],[{"start":2,"end":4,"cssClass":"pl-k"},{"start":6,"end":7,"cssClass":"pl-k"},{"start":7,"end":13,"cssClass":"pl-smi"}],[{"start":4,"end":14,"cssClass":"pl-c1"},{"start":15,"end":63,"cssClass":"pl-s"},{"start":15,"end":16,"cssClass":"pl-pds"},{"start":62,"end":63,"cssClass":"pl-pds"}],[{"start":4,"end":14,"cssClass":"pl-c1"},{"start":15,"end":55,"cssClass":"pl-s"},{"start":15,"end":16,"cssClass":"pl-pds"},{"start":52,"end":54,"cssClass":"pl-cce"},{"start":54,"end":55,"cssClass":"pl-pds"}],[{"start":4,"end":10,"cssClass":"pl-k"}],[],[{"start":2,"end":6,"cssClass":"pl-smi"},{"start":7,"end":8,"cssClass":"pl-k"},{"start":9,"end":28,"cssClass":"pl-s"},{"start":9,"end":10,"cssClass":"pl-pds"},{"start":27,"end":28,"cssClass":"pl-pds"}],[{"start":2,"end":9,"cssClass":"pl-k"},{"start":10,"end":12,"cssClass":"pl-smi"},{"start":13,"end":15,"cssClass":"pl-k"},{"start":17,"end":22,"cssClass":"pl-k"},{"start":23,"end":29,"cssClass":"pl-smi"}],[{"start":3,"end":10,"cssClass":"pl-k"},{"start":11,"end":13,"cssClass":"pl-smi"},{"start":14,"end":16,"cssClass":"pl-k"},{"start":18,"end":23,"cssClass":"pl-k"},{"start":24,"end":30,"cssClass":"pl-smi"}],[{"start":4,"end":6,"cssClass":"pl-smi"},{"start":7,"end":8,"cssClass":"pl-k"},{"start":13,"end":17,"cssClass":"pl-smi"},{"start":18,"end":19,"cssClass":"pl-k"},{"start":39,"end":40,"cssClass":"pl-k"},{"start":41,"end":54,"cssClass":"pl-c1"},{"start":55,"end":68,"cssClass":"pl-s"},{"start":55,"end":56,"cssClass":"pl-pds"},{"start":57,"end":59,"cssClass":"pl-smi"},{"start":64,"end":66,"cssClass":"pl-smi"},{"start":67,"end":68,"cssClass":"pl-pds"}],[{"start":4,"end":6,"cssClass":"pl-k"},{"start":8,"end":10,"cssClass":"pl-smi"}],[{"start":9,"end":13,"cssClass":"pl-smi"},{"start":14,"end":15,"cssClass":"pl-k"},{"start":16,"end":29,"cssClass":"pl-c1"},{"start":30,"end":43,"cssClass":"pl-s"},{"start":30,"end":31,"cssClass":"pl-pds"},{"start":32,"end":34,"cssClass":"pl-smi"},{"start":39,"end":41,"cssClass":"pl-smi"},{"start":42,"end":43,"cssClass":"pl-pds"}],[{"start":6,"end":14,"cssClass":"pl-k"}],[],[{"start":4,"end":8,"cssClass":"pl-smi"},{"start":9,"end":10,"cssClass":"pl-k"},{"start":11,"end":23,"cssClass":"pl-s"},{"start":11,"end":12,"cssClass":"pl-pds"},{"start":12,"end":14,"cssClass":"pl-smi"},{"start":19,"end":21,"cssClass":"pl-smi"},{"start":22,"end":23,"cssClass":"pl-pds"}],[{"start":4,"end":6,"cssClass":"pl-smi"},{"start":7,"end":8,"cssClass":"pl-k"},{"start":9,"end":19,"cssClass":"pl-c1"}],[{"start":4,"end":28,"cssClass":"pl-smi"},{"start":6,"end":28,"cssClass":"pl-smi"},{"start":29,"end":30,"cssClass":"pl-k"},{"start":31,"end":34,"cssClass":"pl-c1"}],[{"start":4,"end":14,"cssClass":"pl-smi"},{"start":6,"end":14,"cssClass":"pl-smi"},{"start":15,"end":17,"cssClass":"pl-smi"},{"start":17,"end":18,"cssClass":"pl-k"},{"start":18,"end":20,"cssClass":"pl-smi"}],[{"start":4,"end":29,"cssClass":"pl-c"},{"start":4,"end":5,"cssClass":"pl-c"}],[{"start":5,"end":9,"cssClass":"pl-k"},{"start":10,"end":17,"cssClass":"pl-smi"},{"start":12,"end":17,"cssClass":"pl-smi"},{"start":18,"end":19,"cssClass":"pl-c1"},{"start":19,"end":20,"cssClass":"pl-k"},{"start":20,"end":21,"cssClass":"pl-c1"}],[{"start":4,"end":6,"cssClass":"pl-smi"},{"start":7,"end":8,"cssClass":"pl-k"},{"start":9,"end":19,"cssClass":"pl-c1"},{"start":43,"end":63,"cssClass":"pl-k"},{"start":69,"end":70,"cssClass":"pl-k"},{"start":70,"end":71,"cssClass":"pl-c1"}],[{"start":4,"end":6,"cssClass":"pl-smi"},{"start":7,"end":8,"cssClass":"pl-k"},{"start":9,"end":19,"cssClass":"pl-s"},{"start":9,"end":10,"cssClass":"pl-pds"},{"start":18,"end":19,"cssClass":"pl-pds"}],[{"start":4,"end":7,"cssClass":"pl-k"}],[{"start":6,"end":8,"cssClass":"pl-k"},{"start":10,"end":20,"cssClass":"pl-smi"},{"start":12,"end":20,"cssClass":"pl-smi"},{"start":22,"end":25,"cssClass":"pl-k"},{"start":26,"end":28,"cssClass":"pl-smi"}],[{"start":8,"end":71,"cssClass":"pl-c"},{"start":8,"end":9,"cssClass":"pl-c"}],[{"start":8,"end":10,"cssClass":"pl-smi"},{"start":11,"end":12,"cssClass":"pl-k"},{"start":13,"end":19,"cssClass":"pl-s"},{"start":13,"end":14,"cssClass":"pl-pds"},{"start":18,"end":19,"cssClass":"pl-pds"}],[],[{"start":6,"end":11,"cssClass":"pl-k"}],[{"start":6,"end":8,"cssClass":"pl-k"},{"start":10,"end":16,"cssClass":"pl-c1"},{"start":17,"end":18,"cssClass":"pl-c1"},{"start":31,"end":37,"cssClass":"pl-k"},{"start":38,"end":57,"cssClass":"pl-s"},{"start":38,"end":39,"cssClass":"pl-pds"},{"start":56,"end":57,"cssClass":"pl-pds"}],[{"start":8,"end":73,"cssClass":"pl-c"},{"start":8,"end":9,"cssClass":"pl-c"}],[{"start":8,"end":55,"cssClass":"pl-c"},{"start":8,"end":9,"cssClass":"pl-c"}],[{"start":8,"end":10,"cssClass":"pl-k"},{"start":13,"end":26,"cssClass":"pl-c1"},{"start":44,"end":45,"cssClass":"pl-k"},{"start":52,"end":115,"cssClass":"pl-s"},{"start":52,"end":53,"cssClass":"pl-pds"},{"start":64,"end":66,"cssClass":"pl-smi"},{"start":114,"end":115,"cssClass":"pl-pds"},{"start":128,"end":131,"cssClass":"pl-k"},{"start":132,"end":133,"cssClass":"pl-c1"}],[{"start":10,"end":74,"cssClass":"pl-c"},{"start":10,"end":11,"cssClass":"pl-c"}],[{"start":10,"end":81,"cssClass":"pl-c"},{"start":10,"end":11,"cssClass":"pl-c"}],[{"start":10,"end":58,"cssClass":"pl-c"},{"start":10,"end":11,"cssClass":"pl-c"}],[{"start":10,"end":12,"cssClass":"pl-smi"},{"start":13,"end":14,"cssClass":"pl-k"},{"start":15,"end":21,"cssClass":"pl-s"},{"start":15,"end":16,"cssClass":"pl-pds"},{"start":20,"end":21,"cssClass":"pl-pds"}],[],[{"start":8,"end":14,"cssClass":"pl-k"},{"start":16,"end":22,"cssClass":"pl-c1"},{"start":23,"end":24,"cssClass":"pl-c1"},{"start":37,"end":43,"cssClass":"pl-k"},{"start":44,"end":61,"cssClass":"pl-s"},{"start":44,"end":45,"cssClass":"pl-pds"},{"start":60,"end":61,"cssClass":"pl-pds"}],[{"start":8,"end":72,"cssClass":"pl-c"},{"start":8,"end":9,"cssClass":"pl-c"}],[{"start":8,"end":10,"cssClass":"pl-smi"},{"start":11,"end":12,"cssClass":"pl-k"},{"start":13,"end":21,"cssClass":"pl-s"},{"start":13,"end":14,"cssClass":"pl-pds"},{"start":20,"end":21,"cssClass":"pl-pds"}],[],[],[{"start":4,"end":12,"cssClass":"pl-smi"},{"start":6,"end":12,"cssClass":"pl-smi"}],[{"start":4,"end":8,"cssClass":"pl-smi"},{"start":9,"end":11,"cssClass":"pl-k"},{"start":12,"end":14,"cssClass":"pl-smi"}],[{"start":4,"end":14,"cssClass":"pl-c1"},{"start":15,"end":21,"cssClass":"pl-s"},{"start":15,"end":16,"cssClass":"pl-pds"},{"start":16,"end":20,"cssClass":"pl-smi"},{"start":20,"end":21,"cssClass":"pl-pds"}],[{"start":9,"end":13,"cssClass":"pl-smi"},{"start":14,"end":16,"cssClass":"pl-k"},{"start":16,"end":20,"cssClass":"pl-smi"}],[],[],[],[],[{"start":0,"end":11,"cssClass":"pl-c"},{"start":0,"end":1,"cssClass":"pl-c"}],[{"start":0,"end":1,"cssClass":"pl-c"},{"start":0,"end":1,"cssClass":"pl-c"}],[{"start":0,"end":29,"cssClass":"pl-c"},{"start":0,"end":1,"cssClass":"pl-c"}],[{"start":0,"end":39,"cssClass":"pl-c"},{"start":0,"end":1,"cssClass":"pl-c"}],[{"start":0,"end":34,"cssClass":"pl-c"},{"start":0,"end":1,"cssClass":"pl-c"}],[{"start":0,"end":44,"cssClass":"pl-c"},{"start":0,"end":1,"cssClass":"pl-c"}],[{"start":0,"end":51,"cssClass":"pl-c"},{"start":0,"end":1,"cssClass":"pl-c"}],[{"start":0,"end":61,"cssClass":"pl-c"},{"start":0,"end":1,"cssClass":"pl-c"}]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/InfosecMatter/Minimalistic-offensive-security-tools/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null,"repoAlertsPath":"/InfosecMatter/Minimalistic-offensive-security-tools/security/dependabot","repoSecurityAndAnalysisPath":"/InfosecMatter/Minimalistic-offensive-security-tools/settings/security_analysis","repoOwnerIsOrg":false,"currentUserCanAdminRepo":false},"displayName":"port-scan-udp.ps1","displayUrl":"https://github.com/InfosecMatter/Minimalistic-offensive-security-tools/blob/master/port-scan-udp.ps1?raw=true","headerInfo":{"blobSize":"2 KB","deleteInfo":{"deleteTooltip":"You must be signed in to make or propose changes"},"editInfo":{"editTooltip":"You must be signed in to make or propose changes"},"ghDesktopPath":"https://desktop.github.com","gitLfsPath":null,"onBranch":true,"shortPath":"d7df721","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2FInfosecMatter%2FMinimalistic-offensive-security-tools%2Fblob%2Fmaster%2Fport-scan-udp.ps1","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"59","truncatedSloc":"58"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"PowerShell","languageID":293,"large":false,"loggedIn":false,"newDiscussionPath":"/InfosecMatter/Minimalistic-offensive-security-tools/discussions/new","newIssuePath":"/InfosecMatter/Minimalistic-offensive-security-tools/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/InfosecMatter/Minimalistic-offensive-security-tools/blob/master/port-scan-udp.ps1","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/InfosecMatter/Minimalistic-offensive-security-tools/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"rawBlobUrl":"https://github.com/InfosecMatter/Minimalistic-offensive-security-tools/raw/master/port-scan-udp.ps1","renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"shortPath":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"InfosecMatter","repoName":"Minimalistic-offensive-security-tools","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"copilotInfo":null,"copilotAccessAllowed":false,"csrf_tokens":{"/InfosecMatter/Minimalistic-offensive-security-tools/branches":{"post":"CywUWZh_cxM8WGo7mkGwGDp7aCmW8Bns-xzAIS1ub7fDaKzH1SumHEZoR9ETeVAsB5maRXLzJjRy3n8PVH8thw"},"/repos/preferences":{"post":"AradDSqrmwfHsE03x6FWVvVpv_UbrB936gkSQxQnJLx4kPb_t0UjjooM060nr1hJhTJrI2SAsWTnmcqmN-0Ldg"}}},"title":"Minimalistic-offensive-security-tools/port-scan-udp.ps1 at master · InfosecMatter/Minimalistic-offensive-security-tools"}